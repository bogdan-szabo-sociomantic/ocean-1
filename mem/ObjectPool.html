<html><head>
	<META http-equiv="content-type" content="text/html; charset=utf-8">
	<title>mem.ObjectPool</title>
	</head><body>
	<h1>mem.ObjectPool</h1>
	<!-- Generated by Ddoc from ObjectPool.d -->
Manages a pool of objects
<br/><br/>
<b>Version:</b><br/>
Jan 2010: Initial release

<br/><br/>
<b>Authors:</b><br/>
David Eckardt

<br/><br/>
<b>Usage:</b><br/>
<pre class="d_code">
            <font color=blue>import</font> mem.ObjectPool

            <font color=green>// The items in pool will be of MyClass:
</font>
            <font color=blue>class</font> MyClass
            {
                <font color=blue>this</font> ( <font color=blue>int</font> ham, <font color=blue>char</font>[] eggs, <font color=blue>bool</font> sausage )
                { ... }
            }

            <font color=green>// Create an ObjectPool instance managing objects of "MyClass". The
</font>            <font color=green>// template parameters for ObjectPool!() are therefore "MyClass"
</font>            <font color=green>// followed by the types of the constructor arguments of "MyClass".
</font>
            <u>ObjectPool</u> pool = <font color=blue>new</font> <u>ObjectPool</u>!(MyClass, <font color=blue>int</font>, <font color=blue>char</font>[], <font color=blue>bool</font>);

            <font color=green>// Call pool.get() to get an item from "pool", passing the "MyClass"
</font>            <font color=green>// constructor parameters.
</font>
            MyClass item = pool.get(42, <font color=red>"Hello world!"</font>, <font color=blue>true</font>);

</pre>

 
<br/><br/>

<dl><dt><big>class <u>ObjectPool</u>(T,A...);
</big></dt>
<dd><u>ObjectPool</u> class template
<br/><br/>
<b>Params:</b><br/>
<table><tr><td>T</td>
<td>type of items in pool; must be a class</td></tr>
<tr><td>A</td>
<td>types of constructor arguments of class T</td></tr>
</table><br/>

<dl><dt><big>alias <u>This</u>;
</big></dt>
<dd>Convenience <u>This</u> alias
<br/><br/>

</dd>
<dt><big>struct <u>ItemInfo</u>;
</big></dt>
<dd>Information structure for a single item
<br/><br/>

</dd>
<dt><big>size_t <u>max</u>;
</big></dt>
<dd>Maximum number of items in pool if limitation enabled
<br/><br/>

</dd>
<dt><big>ItemInfo[PoolItem] <u>items</u>;
</big></dt>
<dd>List of <u>items</u>: Associative array of information structure with item
                       instance as index.
                       The PoolItem class is derived from the supplied T class;
                       its only purpose is to override some methods of the
                       Object class which is necessary in order to use PoolItem
                       as an associative array index type. Hence it is safe to
                       think of PoolItem as an alias of T.
                       The PoolItem class definition is at the end of this
                       class.
<br/><br/>

</dd>
<dt><big>hash_t <u>serial</u>;
</big></dt>
<dd>Serial number as unique identifier for pool items. As the PoolItem class
        this is required in order to build the associative array and counted up
        on each item creation.
<br/><br/>

</dd>
<dt><big>bool <u>limited</u>;
</big></dt>
<dd><b>true:</b><br/>
Allow at most "max" items in pool
<br/><br/>

     
<br/><br/>

</dd>
<dt><big>A <u>args</u>;
</big></dt>
<dd>Default constructor arguments for pool item creation
<br/><br/>

</dd>
<dt><big>this();
</big></dt>
<dd>Constructor
<br/><br/>

</dd>
<dt><big>this(uint n, A args);
</big></dt>
<dd>Constructor; creates n initial pool items.
<br/><br/>
<b>Params:</b><br/>
<table><tr><td>n</td>
<td>number of initial pool items</td></tr>
<tr><td>args</td>
<td>arguments to pass to constructor on pool item creation</td></tr>
</table><br/>

</dd>
<dt><big>PoolItem <u>get</u>(A <i>args</i>);
<br/>PoolItem <u>get</u>();
</big></dt>
<dd>Takes an idle item from the pool or creates a new one if all item are
        busy or the pool is empty.
<br/><br/>
<b>Params:</b><br/>
<table><tr><td>A <i>args</i></td>
<td>arguments to pass to constructor on pool item creation</td></tr>
</table><br/>
<b>Returns:</b><br/>
pool object
<br/><br/>

    
<br/><br/>

</dd>
<dt><big>This <u>back</u>(PoolItem <i>item</i>);
</big></dt>
<dd>Puts <i>item</i> <u>back</u> to the pool.
<br/><br/>
<b>Params:</b><br/>
<table><tr><td>PoolItem <i>item</i></td>
<td><i>item</i> to put <u>back</u></td></tr>
</table><br/>
<b>Returns:</b><br/>
this instance
<br/><br/>

    
<br/><br/>

</dd>
<dt><big>This <u>remove</u>(PoolItem <i>item</i>);
</big></dt>
<dd>Removes <i>item</i> from pool and deletes it.
<br/><br/>
<b>Params:</b><br/>
<table><tr><td>PoolItem <i>item</i></td>
<td><i>item</i> <u>remove</u></td></tr>
</table><br/>
<b>Returns:</b><br/>
this instance
<br/><br/>

    
<br/><br/>

</dd>
<dt><big>This <u>limit</u>(bool <i>limited</i>);
</big></dt>
<dd>Enables/disables limitation of number of items in pool.
<br/><br/>
<b>Params:</b><br/>
<table><tr><td>bool <i>limited</i></td>
<td><b>true</b> enables, <b>false</b> disables limitation</td></tr>
</table><br/>
<b>Returns:</b><br/>
this instance
<br/><br/>

    
<br/><br/>

</dd>
<dt><big>This <u>setNumItems</u>(size_t <i>n</i>, A <i>args</i>);
<br/>This <u>setNumItems</u>(size_t <i>n</i>);
</big></dt>
<dd>Sets the number of items in pool.
<br/><br/>
To achieve this, as many items as required are created or removed.
        If more items are busy than required to be removed, all idle items are
        removed and an exception is thrown.
        If the requested number of items exceeds the limit, the number of items
        is set to the limit and an exception is thrown.

<br/><br/>
<b>Params:</b><br/>
<table><tr><td>size_t <i>n</i></td>
<td>nominate number of values</td></tr>
<tr><td>A <i>args</i></td>
<td>arguments to pass to constructor on pool item creation</td></tr>
</table><br/>
<b>Returns:</b><br/>
this instance
<br/><br/>

    
<br/><br/>

</dd>
<dt><big>size_t <u>getNumItems</u>();
</big></dt>
<dd>Returns the number of items in pool.
<br/><br/>
<b>Returns:</b><br/>
the number of items in pool
<br/><br/>

     
<br/><br/>

</dd>
<dt><big>size_t <u>getNumIdleItems</u>();
</big></dt>
<dd>Returns the number of idle items in pool.
<br/><br/>
<b>Returns:</b><br/>
the number of idle items in pool
<br/><br/>

     
<br/><br/>

</dd>
<dt><big>size_t <u>getNumBusyItems</u>();
</big></dt>
<dd>Returns the number of busy items in pool.
<br/><br/>
<b>Returns:</b><br/>
the number of busy items in pool
<br/><br/>

     
<br/><br/>

</dd>
<dt><big>This <u>setArgs</u>(A <i>args</i>);
</big></dt>
<dd>Sets the default constructor arguments for item creation.
<br/><br/>
<b>Params:</b><br/>
<table><tr><td>A <i>args</i></td>
<td>default constructor arguments for item creation</td></tr>
</table><br/>
<b>Returns:</b><br/>
this instance
<br/><br/>

     
<br/><br/>

</dd>
<dt><big>void <u>checkLimit</u>(char[] <i>msg</i>, bool <i>less</i> = false);
</big></dt>
<dd>Checks whether the number of items in pool is <i>less</i> or equal
        (<i>less</i> == <b>false</b>) or is <i>less</i> (<i>less</i> == <b>true</b>) than the limit and throws an
        exception if not.
<br/><br/>
<b>Params:</b><br/>
<table><tr><td>char[] <i>msg</i></td>
<td>exception message</td></tr>
<tr><td>bool <i>less</i></td>
<td><b>true</b>:  number of items in pool must be <i>less</i> than max;</td></tr>
</table><br/>
<b>false:</b><br/>
number of items in pool must be <i>less</i> than or equal to
                          max
<br/><br/>

    
<br/><br/>

</dd>
<dt><big>PoolItem <u>create</u>(A <i>args</i>, bool <i>idle</i> = false);
</big></dt>
<dd>Creates a pool item with <i>idle</i> status <i>idle</i>.
<br/><br/>
<b>Params:</b><br/>
<table><tr><td>A <i>args</i></td>
<td>pool item constructor arguments</td></tr>
<tr><td>bool <i>idle</i></td>
<td><i>idle</i> status of new pool item</td></tr>
</table><br/>
<b>Returns:</b><br/>
new pool item
<br/><br/>

    
<br/><br/>

</dd>
<dt><big>template <u>arglist</u>(char[] name,A...)</big></dt>
<dd>PoolItem instantiation argument list templates
<br/><br/>
Generates the argument list for the tuple "name" of arguments with types
        of tuple "A". "A" is merely used to determine the argument list length.

<br/><br/>
<b>Example:</b><br/>
<pre class="d_code">
            <font color=blue>const</font> list = <u>arglist</u>!(<font color=red>"x"</font>, <font color=blue>int</font>, <font color=blue>char</font>[], <font color=blue>bool</font>);

            <font color=green>// "list" now holds "x[0],x[1],x[2]"
</font>
</pre>

<br/><br/>
<b>Params:</b><br/>
<table><tr><td>name</td>
<td>name of the tuple of arguments</td></tr>
<tr><td>A</td>
<td>tuple of argument types</td></tr>
</table><br/>
<b>Returns:</b><br/>
generated argument list string
<br/><br/>

     
<br/><br/>

</dd>
<dt><big>template <u>arglist</u>(char[] list,int i,char[] name,A...)</big></dt>
<dd>Generates the argument list for the tuple "name" of arguments with types
        of tuple "A", starting with index "i", and appends the list to "list".
        "A" is merely used to determine the number of arguments.
<br/><br/>
<b>Example:</b><br/>
<pre class="d_code">
            <font color=blue>const</font> list = <u>arglist</u>!(<font color=red>"items_before"</font>, 3, <font color=red>"x"</font>, <font color=blue>int</font>, <font color=blue>char</font>[], <font color=blue>bool</font>);

            <font color=green>// "list" now holds "items_before,x[3],x[4],x[5]"
</font>
</pre>

<br/><br/>
<b>Params:</b><br/>
<table><tr><td>list</td>
<td>list to append generated list</td></tr>
<tr><td>i</td>
<td>start index</td></tr>
<tr><td>name</td>
<td>name of the tuple of arguments</td></tr>
<tr><td>A</td>
<td>tuple of argument types</td></tr>
</table><br/>

</dd>
<dt><big>template <u>appendArg</u>(char[] list,int i,char[] name)</big></dt>
<dd>Generates an argument list item for the tuple "name" of arguments with
        index "i" and appends the item to "list".
<br/><br/>
<b>Example:</b><br/>
<pre class="d_code">
            <font color=blue>const</font> list = <u>appendArg</u>!(<font color=red>"item_before"</font>, 42, <font color=red>"x"</font>);

            <font color=green>// "list" now holds "item_beforex[42]"
</font>
</pre>

<br/><br/>
<b>Params:</b><br/>
<table><tr><td>list</td>
<td>list to append generated item</td></tr>
<tr><td>i</td>
<td>item index</td></tr>
<tr><td>name</td>
<td>name of the tuple of items</td></tr>
</table><br/>

</dd>
<dt><big>class <u>PoolItem</u>: T;
</big></dt>
<dd><u>PoolItem</u> class
<br/><br/>
According to the D specification, a class used as associative array
         index shall override toHash(), opEquals() and opCmp(). The <u>PoolItem</u>
         class extends the supplied class T in this manner. Comparison and hash
         use the same private "hash" property whose value is supplied on
         instantiation.
<br/><br/>

     
<br/><br/>

<dl><dt><big>hash_t <u>hash</u>;
</big></dt>
<dd>Hash value, also used for comparison
<br/><br/>

</dd>
<dt><big>this(hash_t hash, A args);
</big></dt>
<dd>Constructor
<br/><br/>
<b>Params:</b><br/>
<table><tr><td>hash</td>
<td>hash value</td></tr>
<tr><td>args</td>
<td>super class constructor arguments</td></tr>
</table><br/>

</dd>
<dt><big>hash_t <u>toHash</u>();
</big></dt>
<dd>Returns the hash value.
<br/><br/>
<b>Returns:</b><br/>
the hash value
<br/><br/>

        
<br/><br/>

</dd>
<dt><big>int <u>opEquals</u>(Object <i>obj</i>);
</big></dt>
<dd>Checks this instance for identitiy to <i>obj</i>.
<br/><br/>
<b>Returns:</b><br/>
<b>true</b> if <i>obj</i> is identical to this instance or <b>false</b> otherwise
<br/><br/>

        
<br/><br/>

</dd>
<dt><big>int <u>opCmp</u>(Object <i>obj</i>);
</big></dt>
<dd>Compares this instance to <i>obj</i>.
<br/><br/>
<b>Returns:</b><br/>
- 0 if if <i>obj</i> is identical to this instance,
                - the difference between the hashes of this instance and <i>obj</i>
                  if comparison in this manner is possible or
                - the least possible value otherwise.
<br/><br/>

        
<br/><br/>

</dd>
</dl>
</dd>
</dl>
</dd>
</dl>

	<hr><small>Page generated by <a href="http://www.digitalmars.com/d/1.0/ddoc.html">Ddoc</a>. Copyright (c) 2009 sociomantic labs. All rights reserved

</small>
	</body></html>
